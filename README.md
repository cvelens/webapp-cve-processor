# CVE Processor Web Application

The CVE Processor Web Application is a Go-based application that downloads, processes, and stores Common Vulnerabilities and Exposures (CVE) data in a PostgreSQL database. It is designed to handle CVE records in the CVE Record Format and supports versioning of CVE records.

## Prerequisites

Before building and running the application, ensure that you have the following prerequisites installed:

- Go (version 1.16 or higher)
- PostgreSQL (version 12 or higher)
- Docker (for containerization)
- Flyway (for database migrations)

## Build and Deploy Instructions

Follow these steps to build and deploy the CVE Processor Web Application:

1. Clone the repository:
```
git clone https://github.com/your-username/webapp-cve-processor.git
```

2. Navigate to the project directory:
```
cd webapp-cve-processor
```

3. Configure the database connection:
- Open the `main.go` file and update the database connection details in the `sql.Open` function call.
- Ensure that you have created a PostgreSQL database named `cve` and a schema named `cve`.

4. Run the database migrations using Flyway:
- Install Flyway by following the official documentation: [Flyway Installation](https://flywaydb.org/documentation/installation/)
- Configure Flyway to connect to your PostgreSQL database by updating the `flyway.conf` file with your database connection details.
- Run the following command to execute the database migrations:
  ```
  flyway migrate
  ```

5. Build the application:
```
go build -o cve-processor
```

6. Run the application:
```
./cve-processor
```

The application will start processing CVE records from the `cve_data.zip` file and store them in the PostgreSQL database.

7. Containerize the application (optional):
- Build the Docker image:
  ```
  docker build -t cve-processor .
  ```
- Run the Docker container:
  ```
  docker run -d --name cve-processor cve-processor
  ```

## CVE Data Processing

The CVE Processor Web Application performs the following steps to process CVE data:

1. Downloads the CVE records from the `cve_data.zip` file.
2. Extracts the JSON files from the ZIP archive.
3. Parses each JSON file and extracts relevant CVE information.
4. Stores the CVE records in the PostgreSQL database using the `cve` schema.
5. Supports versioning of CVE records by storing each version as a separate row in the database.

The application handles duplicate records by incrementing the version number for each new version of a CVE record.

## Database Schema

The CVE Processor Web Application uses the following database schema:

```sql
CREATE TABLE IF NOT EXISTS cve (
 id TEXT,
 version INTEGER,
 assigner_org_id TEXT,
 assigner_short_name TEXT,
 date_published TEXT,
 date_reserved TEXT,
 date_updated TEXT,
 state TEXT,
 data JSONB,
 created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
 PRIMARY KEY (id, version)
);
```

The cve table stores the CVE records with versioning information. The data column uses the JSONB data type to store the entire CVE JSON document.

## Contributing

Please follow the standard GitHub workflow:

1. Fork the repository.
2. Create a new branch for your feature or bug fix.
3. Make your changes and commit them with descriptive messages.
4. Push your changes to your forked repository.
5. Submit a pull request to the main repository.

Please ensure that your code follows the existing style and conventions used in the project.