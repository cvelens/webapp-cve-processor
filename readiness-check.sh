#!/bin/bash

# Kafka 
kafka_broker="${KAFKA_BROKERS}"
if ! kafka-topics.sh --bootstrap-server "${kafka_broker}" --list &> /dev/null; then
  echo "Kafka is not reachable"
  exit 1
fi
echo "Kafka is reachable"

# Kafka topic
kafka_topic="${KAFKA_TOPIC}"
if ! kafka-topics.sh --bootstrap-server "${kafka_broker}" --list | grep -q "${kafka_topic}"; then
  echo "Kafka topic ${kafka_topic} does not exist"
  exit 1
fi
echo "Kafka topic ${kafka_topic} exists"

# All checks
exit 0
