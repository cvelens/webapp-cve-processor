#!/bin/bash

# Kafka 
if ! kafka-topics.sh --bootstrap-server "${KAFKA_BROKERS}" --list &> /dev/null; then
  echo "Kafka is not reachable"
  exit 1
fi
echo "Kafka is reachable"

# Kafka topic
if ! kafka-topics.sh --bootstrap-server "${KAFKA_BROKERS}" --list | grep -q "${KAFKA_TOPIC}"; then
  echo "Kafka topic ${KAFKA_TOPIC} does not exist"
  exit 1
fi
echo "Kafka topic ${KAFKA_TOPIC} exists"

# All checks
exit 0
